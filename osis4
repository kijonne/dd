# Лабораторное занятие №4: Исследование параметров настройки реестра в ОС Windows

## Цель работы
Исследовать и провести настройки в ОС Windows XP с помощью реестра.

## Оборудование
- Персональный компьютер
- Программа Virtual Box
- Образ операционной системы Windows XP

## Порядок выполнения работы

### 1. Подготовка виртуальной машины
1. **Скопируйте образ ОС Windows 10** из папки `C:\VM\Win10.vdi` в каталог `C:\Temp`.
2. **Запустите Virtual Box** с помощью ярлыка на рабочем столе.
3. **Запустите ОС Windows 10** в Virtual Box.
4. **Создайте точку восстановления** с именем, соответствующим текущей дате.

### 2. Работа с реестром
5. **Запустите редактор реестра**:
   - Нажмите `Win + R`, введите `regedit` и нажмите `Enter`.
6. **Изучите корневые разделы реестра**:
   - `HKEY_CLASSES_ROOT` (HKCR): Связи расширений файлов с программами.
   - `HKEY_CURRENT_USER` (HKCU): Настройки текущего пользователя.
   - `HKEY_LOCAL_MACHINE` (HKLM): Настройки всей системы.
   - `HKEY_USERS` (HKU): Настройки всех пользователей.
   - `HKEY_CURRENT_CONFIG` (HKCC): Текущая конфигурация оборудования.

7. **Экспорт реестра**:
   - Выберите раздел (например, `HKEY_CURRENT_USER`).
   - В меню "Файл" выберите "Экспорт".
   - Укажите имя файла, диапазон экспорта (весь реестр или выбранную ветвь) и тип файла (например, `.reg`).
   - Нажмите "Сохранить".

### 3. Практические задания
8. **Создание и удаление ключей**:
   - Перейдите в `HKEY_CURRENT_USER\Software`.
   - Создайте новый ключ `TestLab`.
   - Внутри `TestLab` создайте строковый параметр `Greeting` со значением `Hello, World!`.
   - Создайте параметр типа `DWORD` с именем `Flag` и значением `1`.
   - Удалите созданные параметры и ключ.

9. **Изменение обоев рабочего стола**:
   - Перейдите в `HKEY_CURRENT_USER\Control Panel\Desktop`.
   - Измените значение параметра `Wallpaper` на путь к изображению (например, `C:\Windows\Web\Wallpaper\Windows\img0.jpg`).
   - Перезагрузите компьютер для проверки изменений.
   - Верните исходное значение параметра.

10. **Отключение диспетчера задач**:
    - Перейдите в `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System`.
    - Создайте параметр типа `DWORD` с именем `DisableTaskMgr` и значением `1`.
    - Попробуйте открыть диспетчер задач (`Ctrl + Shift + Esc`). Он должен быть заблокирован.
    - Удалите параметр или измените его значение на `0`, чтобы восстановить доступ.

11. **Создание ассоциации файлов**:
    - В разделе `HKEY_CLASSES_ROOT` создайте новый ключ `.mylab`.
    - Создайте подраздел `Shell\Open\Command`.
    - Задайте значение по умолчанию, указывающее на программу (например, `notepad.exe`).
    - Создайте текстовый файл с расширением `.mylab` и проверьте, что он открывается в блокноте.

12. **Удаление ключа .txt**:
    - Удалите ключ `HKEY_CLASSES_ROOT\.txt`.
    - Попробуйте открыть текстовый файл. Система не сможет его открыть, так как потеряна ассоциация.
    - Восстановите ключ из резервной копии или вручную.

13. **Добавление пункта в контекстное меню**:
    - Перейдите в `HKEY_CLASSES_ROOT\Directory\Background\shell`.
    - Создайте новый ключ `OpenWithNotepad`.
    - Внутри ключа создайте строковый параметр `(По умолчанию)` со значением `Открыть в Блокноте`.
    - Создайте подраздел `command` и задайте значение по умолчанию `C:\Windows\System32\notepad.exe`.
    - Нажмите ПКМ на рабочем столе и убедитесь, что новый пункт появился.

14. **Добавление иконки к пункту меню**:
    - Внутри ключа `OpenWithNotepad` создайте строковый параметр `Icon`.
    - Задайте значение параметра как путь к иконке (например, `C:\Windows\System32\notepad.exe` или `.ico` файл).
    - Проверьте, что в контекстном меню появилась иконка.

15. **Создание файлов для изменения обоев**:
    - Создайте `.reg` файлы, меняющие значение параметра `Wallpaper` на разные изображения.
    - Восстановите исходные настройки через редактор реестра.

16. **Восстановление системы**:
    - Восстановите систему с помощью созданной точки восстановления.

17. **Завершение работы**:
    - Завершите работу в ОС.
    - Удалите образ ОС Windows XP из папки `C:\Work`.

18. **Проверка преподавателем**:
    - Позовите преподавателя для проверки выполненной работы.

## Контрольные вопросы
1. **Назначение реестра**: Реестр Windows — это база данных, хранящая настройки операционной системы, программ и пользователей. Он используется для управления конфигурацией системы.
2. **Порядок работы с реестром**:
   - Запустите `regedit`.
   - Перейдите к нужному разделу.
   - Создавайте, изменяйте или удаляйте ключи и параметры.
   - Экспортируйте резервные копии перед внесением изменений.
3. **Поиск по реестру**:
   - В редакторе реестра нажмите `Ctrl + F`.
   - Введите искомое значение и нажмите "Найти далее".

## Вывод
В ходе лабораторной работы были изучены основные разделы реестра Windows, выполнены практические задания по созданию, изменению и удалению ключей и параметров. Были освоены методы резервного копирования и восстановления реестра, а также добавления пользовательских пунктов в контекстное меню. Работа с реестром требует внимательности, так как неосторожные изменения могут повлиять на стабильность системы.
